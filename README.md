# PBS-On-Docker
OpenPBSをDocker Conainer上で動作させることを目的に作成したもの。
都度、手動でビルドする手間を省くことやテンプレートを用意しておくことを目的として作成した。
現時点での本Dockerfileの記述では、管理ノードとしての機能のみが有効化されてコンテナが起動する。

そのため、本レポジトリのテンプレートのままにビルド+ 起動したコンテナとは別に、計算ノードを各自で用意し、コンテナへ接続する必要がある。(/etc/pbs.confの中で指定する)

## コンテナ起動コマンド(run.sh)
OpenPBSで利用するポートを考慮に入れて以下のように実行する。
```
docker run -p 15001:15001 -p 15002:15002 -p 15003:15003 -p 15004:15004 -p 15005:15005 -p 15006:15006 -p 15007:15007 -p 15008:15008 -p 15009:15009 -p 17001:17001 --hostname headnode --name pbs-headnode -it pbs-headnode
```

現在、修正中ではあるが上記実行後に以下のコマンドをコンテナの中で実行することで、PBSの管理ノードとして、コンテナを利用できるようになる。
```
# サービス開始
/etc/init.d/pbs start 
# 以後はCtrl+p,qでコンテナを離脱して差し支えない
```
なお、計算ノードを追加する際はコンテナ内部のhostsを適宜加筆することで対応する。(今後修正予定です)

## 動作確認環境
以下の環境で正常に動作することを確認済み
- Ubuntu 24.04
- Docker version 20.10.17
- OpenPBS 23.06.06

## その他
課題や問題はissueに記載する。

以上
